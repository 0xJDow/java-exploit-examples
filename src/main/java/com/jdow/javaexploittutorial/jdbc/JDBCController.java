package com.jdow.javaexploittutorial.jdbc;

import org.springframework.web.bind.annotation.*;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.util.List;

@RestController
@RequestMapping(path = "/api/v1/jdbc")
public class JDBCController {

    @GetMapping
    public List<String> autoDeserGet() {
        return List.of("Hello from the JDBCController!");
    }

    @PostMapping
    public void autoDeserPost(@RequestBody DBConnection dbconnection) {
        // Test payload:
        // {
        //    "db_url":"jdbc:mysql://127.0.0.1:3306/mysql?characterEncoding=utf8&useSSL=false&statementInterceptors=com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor&autoDeserialize=true"
        // }
        try {
            Connection conn = DriverManager.getConnection(dbconnection.getDb_url());
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
