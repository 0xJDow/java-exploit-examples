package com.jdow.javaexploitexamples.jndi;

import org.springframework.web.bind.annotation.*;
import org.apache.naming.factory.*;

import javax.naming.NamingException;

@RestController
@RequestMapping(path = "/api/v1/jndi")
public class JNDIController {

    @GetMapping(produces = "application/json")
    public String jndiInjectGet() {
        return "Hello from the JNDIController!";
    }

    @PostMapping()
    public Object jndiInjectionPost(@RequestBody JNDIPayload payload) throws NamingException {
        // Test payload:
        // {
        //    "name":"rmi://127.0.0.1:1097/Object"
        // }
        return new javax.naming.InitialContext().lookup(payload.getName());
    }
}
